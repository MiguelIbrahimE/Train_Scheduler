// .devcontainer/devcontainer.json  (minimal, copy-paste)

// --------------------------------------------------------------------------
// 1) keep the default workspace folder VS Code provides
// --------------------------------------------------------------------------
{
  "name": "Rail-Scheduler",
  "image": "rail-scheduler:latest",
  "context": "..",
  "dockerFile": "Dockerfile",

  // <-- remove the custom workspaceFolder so VS Code uses
  //     /workspaces/${localWorkspaceFolderBasename} automatically
  // "workspaceFolder": "/workspace",

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "iredelmeier.dagster-extension"
      ]
    }
  },

  "forwardPorts": [3000],

  // ----------------------------------------------------------------------
  // 2) run the pipeline once, then start Dagster UI
  //    wrap BOTH commands in a single Bash invocation
  // ----------------------------------------------------------------------
  "postStartCommand": "/bin/bash -c \"dagster asset materialize -m pipeline && dagster dev -m pipeline -h 0.0.0.0 -p 3000 &\"",

  "settings": {
    "python.defaultInterpreterPath": "/usr/local/bin/python"
  }
}
